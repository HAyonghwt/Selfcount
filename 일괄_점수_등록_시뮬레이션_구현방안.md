# 일괄 점수 등록 시뮬레이션 구현 방안

## 현재 상태 확인

### 1. "조장 점수 등록" 확인
- **확인 결과**: ✅ 맞습니다. 현재 "조장 점수 등록"은 실제로 조장 점수 등록입니다.
- **저장 경로**: `/scores/${playerId}/${courseId}/${hole}`
- **차이점**: 
  - 실제 조장 점수 입력 페이지는 `logScoreChange`를 호출하여 점수 로그를 기록합니다.
  - 현재 시뮬레이션 도구의 "조장 점수 등록"은 점수 로그를 기록하지 않습니다.

### 2. 일괄 입력 모드와의 차이
- **저장 경로**: 동일 (`/scores/${playerId}/${courseId}/${hole}`)
- **점수 로그**: 일괄 입력 모드는 `logScoreChange`를 호출하여 점수 로그를 기록합니다.
- **실제 차이**: 저장 방식은 동일하지만, 점수 로그 기록 여부가 다릅니다.

---

## 구현 방안

### 추가할 기능

1. **일괄 점수 등록 1일차** 버튼
   - 점수 로그를 기록하는 버전의 점수 등록
   - `logScoreChange` 호출 포함

2. **일괄 점수 등록 2일차** 버튼
   - 점수 로그를 기록하는 버전의 점수 등록
   - `logScoreChange` 호출 포함

3. **일괄 자동실행** 버튼
   - 300명 등록 → 1일차 일괄 점수 등록 → 재편성 → 2일차 일괄 점수 등록

---

## 생성될 코드

### 1. 파일 위치
- **파일**: `src/components/SimulationTool.tsx`
- **변경 사항**: 기존 파일에 함수 추가 및 UI 버튼 추가

### 2. 추가될 함수

#### `registerBatchScores` 함수
```typescript
// 일괄 점수 등록 (1일차 또는 2일차) - 점수 로그 포함
const registerBatchScores = async (day: 1 | 2) => {
    // registerCaptainScores와 유사하지만 logScoreChange 호출 추가
    // 점수 저장 시마다 logScoreChange 호출
};
```

#### `runBatchAutoSimulation` 함수
```typescript
// 일괄 자동실행
const runBatchAutoSimulation = async () => {
    // 1. 300명 등록
    // 2. 1일차 일괄 점수 등록
    // 3. 조 재편성
    // 4. 2일차 일괄 점수 등록
};
```

### 3. 추가될 UI 버튼

```typescript
// 일괄 점수 등록 버튼 (1일차)
<Button
    onClick={() => registerBatchScores(1)}
    disabled={simulationState.isRunning}
    className="bg-cyan-600 hover:bg-cyan-700"
>
    <Trophy className="mr-2 h-4 w-4" />
    일괄 점수 등록
    <span className="ml-2 text-xs">(1일차)</span>
</Button>

// 일괄 점수 등록 버튼 (2일차)
<Button
    onClick={() => registerBatchScores(2)}
    disabled={simulationState.isRunning}
    className="bg-cyan-600 hover:bg-cyan-700"
>
    <Trophy className="mr-2 h-4 w-4" />
    일괄 점수 등록
    <span className="ml-2 text-xs">(2일차)</span>
</Button>

// 일괄 자동실행 버튼
<Button
    onClick={runBatchAutoSimulation}
    disabled={simulationState.isRunning}
    className="bg-cyan-600 hover:bg-cyan-700 col-span-full"
>
    <Trophy className="mr-2 h-4 w-4" />
    일괄 자동실행 (300명 등록 → 1일차 → 재편성 → 2일차)
</Button>
```

### 4. 필요한 Import 추가

```typescript
import { logScoreChange } from '@/lib/scoreLogs';
```

---

## 기존 코드에 대한 영향

### ✅ 영향 없음 (안전)

1. **기존 함수 유지**
   - `registerCaptainScores` 함수는 그대로 유지
   - `runCaptainAutoSimulation` 함수도 그대로 유지
   - 기존 버튼들도 모두 유지

2. **새로운 함수 추가**
   - `registerBatchScores`: 새로운 함수 추가 (기존 함수 수정 없음)
   - `runBatchAutoSimulation`: 새로운 함수 추가 (기존 함수 수정 없음)

3. **UI 추가**
   - 기존 버튼들 옆에 새로운 버튼 추가
   - 기존 레이아웃에 영향 없음

4. **의존성**
   - `logScoreChange`는 이미 `@/lib/scoreLogs`에 존재
   - 새로운 의존성 추가 없음

---

## 코드 구조

### 함수별 역할

1. **`registerCaptainScores`** (기존)
   - 조장 점수 등록 (점수 로그 없음)
   - 일반 조장 점수 입력 시뮬레이션

2. **`registerBatchScores`** (신규)
   - 일괄 점수 등록 (점수 로그 포함)
   - 일괄 입력 모드 시뮬레이션

3. **`runCaptainAutoSimulation`** (기존)
   - 조장 자동실행 (조장 점수 등록 사용)

4. **`runBatchAutoSimulation`** (신규)
   - 일괄 자동실행 (일괄 점수 등록 사용)

---

## 구현 세부 사항

### `registerBatchScores` 함수 구현

```typescript
const registerBatchScores = async (day: 1 | 2) => {
    // 1. registerCaptainScores와 동일한 로직
    // 2. 점수 저장 시 logScoreChange 호출 추가
    // 3. modifiedByType: 'captain' (일괄 입력 모드도 조장으로 기록)
    // 4. comment에 "일괄 입력 모드" 표시
};
```

### `runBatchAutoSimulation` 함수 구현

```typescript
const runBatchAutoSimulation = async () => {
    // 1. 기존 데이터 삭제
    // 2. 300명 등록
    // 3. 1일차 일괄 점수 등록 (registerBatchScores(1))
    // 4. 조 재편성
    // 5. 2일차 일괄 점수 등록 (registerBatchScores(2))
    // 6. 상태 확인 및 보고서 생성
};
```

---

## 결론

### 생성될 코드
- **파일**: `src/components/SimulationTool.tsx` (기존 파일 수정)
- **추가 코드량**: 약 200-300줄
- **새 파일**: 없음

### 기존 코드 영향
- ✅ **영향 없음**: 기존 함수와 버튼은 모두 유지
- ✅ **안전**: 새로운 기능만 추가

### 구현 후 기능
1. 조장 점수 등록 (기존) - 점수 로그 없음
2. 일괄 점수 등록 (신규) - 점수 로그 포함
3. 조장 자동실행 (기존)
4. 일괄 자동실행 (신규)

이렇게 하면 조장 점수 등록과 일괄 점수 등록을 별도로 시뮬레이션할 수 있습니다.

